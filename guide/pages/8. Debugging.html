<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
        <title>8. Debugging</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8"/>
    </head>
    <body class="body">
    Due to the processing of resources, it can be tricky to diagnose problems when something is not working - your styling may not be coming through correctly, or you are getting weird JS errors.<p class="paragraph"/>Usually these are due to incorrect dependencies in your modules, but you may also have actual bugs in your JS or CSS.<p class="paragraph"/>When you're using mappers that completely rename or aggregate files, it can be hard to tell where the problem lies.<p class="paragraph"/>There are a number of features in Resources that make it easier to debug such issues.<p class="paragraph"/>First: Get familiar with your browser's resource inspector. All modern browsers have a developer mode which lets you inspect the resources loaded by a page - including the request and response headers and the content itself. This is indispensable. For Safari you need to explicitly turn this on. For Firefox you may need to install firebug.<p class="paragraph"/><h2>The custom response header</h2><p class="paragraph"/>Every resource served by the plugin in development mode adds the <strong class="bold">X-Grails-Resources-Original-Src</strong> header to all resources served.<p class="paragraph"/>The value shows you the original filename of the resource. In the case of bundled resources, the first part is the bundle name, and then follow all the names of the resources appended to the file, in the order they appear.<p class="paragraph"/><h2>The quick debug option - turn off processing for the current request</h2><p class="paragraph"/>Any URL in your application can have the query parameter <strong class="bold">_debugResources=y</strong> added to it, and the request will perform no processing. So for example if you are browsing <strong class="bold">http://localhost:8080/myapp/admin</strong> and need to bypass resources, just change the URL in your browser to
<strong class="bold">http://localhost:8080/myapp/admin?_debugResources=y</strong><p class="paragraph"/>Dependency management will still be in effect (otherwise your app would break) but the resources will not be bundled or have other mappers applied. Resources will be served with a timestamp - this allows you to set breakpoints on resources and yet also force a refresh in your browser if you find that your browser still caches resources even after you have edited them and no caching headers are set. If this occurs, you can force a timestamp refresh by adding <strong class="bold">_refreshResources=y</strong> to the query params.<p class="paragraph"/><h2>The nuclear debug option - turn on resource debugging all the time </h2><p class="paragraph"/>You can turn off resource processing completely with the trivial Config variable, so that it is as if every request you make has _debugResources=y appended to it:<p class="paragraph"/><div class="code"><pre>grails.resources.debug = <span class="java&#45;keyword">true</span></pre></div><p class="paragraph"/>You can specify this value per-environment in your Config.<p class="paragraph"/><h2>Inspecting your dependency data</h2><p class="paragraph"/>A utility function in ResourceService can be used to output the current resource metadata that the plugin has - all the modules and resources and their dependencies.<p class="paragraph"/>Simply add a "println resourceService.dumpResources()" somewhere in your application or GSP and it will come out.<p class="paragraph"/><h2>Turning on debug logging</h2><p class="paragraph"/>There are copious amounts of debug logging output by the plugin that should make it relatively easy to track down problems. This information includes the order of mapper execution that will be used, the dependency order of your resource module definitions, and all the steps of processing each resource.<p class="paragraph"/>To enable debug logging add this to your Config logging section:<p class="paragraph"/><div class="code"><pre>debug <span class="java&#45;quote">"org.grails.plugin.resource"</span></pre></div>
    </body>
</html>
